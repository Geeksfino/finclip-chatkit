# ChatKit 架构概述

ChatKit 结合三层为 Apple 平台提供对话式 AI 体验：

1. **NeuronKit 编排** – 管理会话、能力清单和工具执行策略。
2. **ConvoUI 展示** – 在 SwiftUI/UIKit 中渲染聊天时间线、交互卡片和系统状态。
3. **ChatKit 适配器层** – 将应用程序代码粘合到 NeuronKit 和 ConvoUI，处理持久化、分析钩子和主题默认值。

```
┌───────────────────────────────────────┐
│           应用层                      │
│  (您的应用、自定义工具/UI 模块)       │
└───────────────────────────────────────┘
              │
              ▼
┌───────────────────────────────────────┐
│           ChatKit 适配器              │
│  - 运行时配置                         │
│  - 会话生命周期辅助工具               │
│  - 主题 + 策略默认值                  │
└───────────────────────────────────────┘
              │
              ▼
┌─────────────┬────────────┬───────────┐
│  NeuronKit  │  ConvoUI   │  Convstore│
│  编排       │  渲染      │  存储     │
└─────────────┴────────────┴───────────┘
              │
              ▼
┌───────────────────────────────────────┐
│        AI 提供者 / 工具 API           │
└───────────────────────────────────────┘
```

## 关键概念

- **会话（Session）**：将消息、参与者和策略绑定在一起。
- **能力清单（Capability manifest）**：由 NeuronKit 强制执行的声明式工具列表。
- **消息存储（Message store）**：Convstore 提供快照和增量更新。
- **适配器钩子（Adapter hooks）**：用于分析和自定义 UX 反应的拦截点。

## 数据流

1. 应用通过适配器启动会话。
2. NeuronKit 根据清单评估传入事件。
3. Convstore 持久化状态，通知适配器，并向 ConvoUI 组件提供数据。
4. ConvoUI 渲染时间线、快捷回复、状态横幅和媒体。
5. 工具调用和 AI 响应循环回到 NeuronKit 以继续编排。

## 下一步

- 参见 `docs/architecture/runtime-lifecycle.md` 获取生命周期图。
- 访问 `docs/how-to/customize-ui.md` 为您的品牌定制 ChatKit。
- 查看 `docs/reference/`（即将推出）获取 API 级别的详细信息。
